(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{In:()=>U,_X:()=>D,eU:()=>j,vV:()=>P,N_:()=>O,fT:()=>I,N5:()=>T});var t={baseUrl:"https://nomoreparties.co/v1/wbf-cohort-6/",headers:{authorization:"54974c2d-ab71-4b56-9932-c842ca70e522","Content-Type":"application/json"}};function o(e){return e.ok?e.json():e.json().then((function(t){console.error("Ошибка HTTP: "+e.status,t)}))}var n={form:".popup__form",input:".popup__edit",button:".popup__save",disabled:"popup__save_disabled",error:"popup__edit_error"},r=function(e){var t=Array.from(e.querySelectorAll(n.input)),o=e.querySelector(n.button);a(t,o),t.forEach((function(r){r.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.error),o.textContent=""}(e,t):function(e,t,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n.error),r.textContent=o}(e,t,t.validationMessage)})(e,r),a(t,o)}))}))};function c(e){a(Array.from(e.querySelectorAll(n.input)),e.querySelector(n.button))}var i=function(e){return e.some((function(e){return!e.validity.valid}))};function a(e,t){i(e)?(t.classList.add(n.disabled),t.setAttribute("disabled","disabled")):(t.classList.remove(n.disabled),t.removeAttribute("disabled"))}var u,d=document.querySelector(".profile__avatar"),l=document.querySelector(".profile__name"),s=document.querySelector(".profile__job"),p=document.getElementById("name-input"),f=document.getElementById("job-input"),_=document.getElementById("avatar-input");function h(e){e.classList.add("popup_opened"),document.addEventListener("keydown",m),e.addEventListener("click",v)}function y(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",m),e.removeEventListener("click",v)}function m(e){"Escape"===e.key&&y(document.querySelector(".popup_opened"))}function v(e){e.target.classList.contains("popup_opened")&&y(document.querySelector(".popup_opened"))}function g(e,t,o,n){var r=e.target.querySelector(".popup__save");t?r.textContent=n:setTimeout((function(){r.textContent=o}),500)}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}var S=document.querySelector(".photo-grid__list"),q=document.getElementById("place-input"),k=document.getElementById("url-input"),E=document.getElementById("card").content.querySelector(".photo-grid__card");function L(e){var n=E.cloneNode(!0);"object"===b(e)&&e.hasOwnProperty("likes")&&(n.querySelector(".photo-grid__likes").textContent=e.likes.length),e.owner._id!==u&&n.querySelector(".photo-grid__delete").remove(),function(e,n){var r=n.querySelector(".photo-grid__like");r.addEventListener("click",(function(e){r.classList.contains("photo-grid__like_active")?function(e){var n=e.target.closest(".photo-grid__card"),r=n.getAttribute("data-id"),c=n.querySelector(".photo-grid__likes");(function(e){return fetch("".concat(t.baseUrl,"cards/likes/").concat(e),{method:"DELETE",headers:t.headers}).then(o)})(r).then((function(t){e.target.classList.remove("photo-grid__like_active"),c.textContent=t.likes.length})).catch((function(e){console.error("Ошибка в функции dislikeCard:",e)}))}(e):function(e){var n=e.target.closest(".photo-grid__card"),r=n.getAttribute("data-id"),c=n.querySelector(".photo-grid__likes");(function(e){return fetch("".concat(t.baseUrl,"cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then(o)})(r).then((function(t){e.target.classList.add("photo-grid__like_active"),c.textContent=t.likes.length})).catch((function(e){console.error("Ошибка в функции likeCard:",e)}))}(e)})),e.likes.find((function(e){return e._id===u}))&&r.classList.add("photo-grid__like_active")}(e,n);var r=n.querySelector(".photo-grid__image"),c=r.getAttribute("alt"),i="".concat(c," ").concat(e.name);return r.setAttribute("alt",i),n.setAttribute("data-id",e._id),n.querySelector(".photo-grid__city").textContent=e.name,n.querySelector(".photo-grid__image").src=e.link,n.querySelector(".photo-grid__image").addEventListener("click",A),n.querySelector(".photo-grid__delete")&&n.querySelector(".photo-grid__delete").addEventListener("click",x),n}var C="";function x(e){C=e.target.closest(".photo-grid__card").getAttribute("data-id"),h(I)}function A(e){var t=e.target,o=t.closest(".photo-grid__card").querySelector(".photo-grid__city");j.textContent=o.textContent,D.src=t.src,h(P)}var T=document.querySelector(".popup_type_profile"),U=document.querySelector(".popup_type_card-form"),P=document.querySelector(".popup_type_image"),j=P.querySelector(".popup__place-name"),D=P.querySelector(".popup__image"),O=document.querySelector(".popup_type_avatar"),I=document.querySelector(".popup_type_delete"),w=T.querySelector(".popup__close"),B=U.querySelector(".popup__close"),N=document.querySelector(".profile__edit"),H=document.querySelector(".profile__button"),J=P.querySelector(".popup__close"),z=document.querySelector(".profile__avatar-overlay"),M=O.querySelector(".popup__close");I.querySelector(".popup__close").addEventListener("click",(function(){y(I)})),M.addEventListener("click",(function(){y(O)})),z.addEventListener("click",(function(){h(O)})),N.addEventListener("click",(function(){h(T)})),H.addEventListener("click",(function(){h(U)})),w.addEventListener("click",(function(){y(T)})),B.addEventListener("click",(function(){y(U)})),J.addEventListener("click",(function(){y(P)})),T.addEventListener("submit",(function(e){e.preventDefault(),g(e,!0,"Сохранить","Cохранение..."),function(e,n){return fetch("".concat(t.baseUrl,"users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:e.value,about:n.value})}).then(o)}(p,f).then((function(t){l.textContent=t.name,s.textContent=t.about,g(e,!1,"Сохранить","Cохранение..."),y(T)})).catch((function(t){g(e,!1,"Сохранить","Cохранение..."),console.error("Ошибка запроса:",t)}))})),U.addEventListener("submit",(function(e){e.preventDefault(),g(e,!0,"Создать","Cохранение..."),function(e,n){return fetch("".concat(t.baseUrl,"cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:e.value,link:n.value})}).then(o)}(q,k).then((function(t){e.target.reset();var o=L(t);S.prepend(o),g(e,!1,"Создать","Cохранение..."),c(U),y(U)})).catch((function(t){g(e,!1,"Создать","Cохранение..."),console.error("Ошибка запроса:",t)}))})),O.addEventListener("submit",(function(e){e.preventDefault(),g(e,!0,"Сохранить","Cохранение..."),function(e){return fetch("".concat(t.baseUrl,"users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:e.value})}).then(o)}(_).then((function(t){g(e,!1,"Сохранить","Cохранение..."),d.src=t.avatar,e.target.reset(),c(O),y(O)})).catch((function(t){g(e,!1,"Сохранить","Cохранение..."),console.error("Ошибка запроса:",t)}))})),I.addEventListener("submit",(function(e){!function(e,n){e.preventDefault(),g(e,!0,"Да","Удаление..."),function(e){return fetch("".concat(t.baseUrl,"cards/").concat(e),{method:"DELETE",headers:t.headers}).then(o)}(n).then((function(){g(e,!1,"Да","Удаление..."),document.querySelector('[data-id="'.concat(n,'"]')).remove(),y(I)})).catch((function(t){g(e,!1,"Да","Удаление..."),console.error("Ошибка в функции deleteCard:",t)}))}(e,C)})),Array.from(document.querySelectorAll(n.form)).forEach((function(e){r(e)})),fetch("".concat(t.baseUrl,"users/me"),{headers:t.headers}).then(o).then((function(e){u=e._id,function(e){l.textContent=e.name,s.textContent=e.about,d.src=e.avatar}(e),p.value=l.textContent,f.value=s.textContent,c(T),fetch("".concat(t.baseUrl,"cards"),{headers:t.headers}).then(o).then((function(e){!function(e){e.forEach((function(e){var t=L(e);S.prepend(t)}))}(e)})).catch((function(e){console.error("Ошибка в функции getDataProfile:",e)}))})).catch((function(e){console.error("Ошибка в функции getDataProfile:",e)}))})();