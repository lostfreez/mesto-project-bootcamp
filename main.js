(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{N_:()=>U,KS:()=>T,fT:()=>D,vi:()=>P,Go:()=>j,DK:()=>O,Rf:()=>x,Xd:()=>A});var t={baseUrl:"https://nomoreparties.co/v1/wbf-cohort-6/",headers:{authorization:"54974c2d-ab71-4b56-9932-c842ca70e522","Content-Type":"application/json"}};function n(e){return e.ok?e.json():e.json().then((function(t){console.error("Ошибка HTTP: "+e.status,t)}))}function o(e,t){c(Array.from(e.querySelectorAll(t.input)),e.querySelector(t.button),t)}var r=function(e){return e.some((function(e){return!e.validity.valid}))};function c(e,t,n){r(e)?(t.classList.add(n.disabled),t.setAttribute("disabled","disabled")):(t.classList.remove(n.disabled),t.removeAttribute("disabled"))}var i,a=document.querySelector(".profile__avatar"),u=document.querySelector(".profile__name"),d=document.querySelector(".profile__job"),l=document.getElementById("name-input"),s=document.getElementById("job-input"),p=document.getElementById("avatar-input");function f(e){e.classList.add("popup_opened"),document.addEventListener("keydown",y),e.addEventListener("click",h)}function _(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",y),e.removeEventListener("click",h)}function y(e){"Escape"===e.key&&_(document.querySelector(".popup_opened"))}function h(e){e.target.classList.contains("popup_opened")&&_(e.target)}function v(e,t,n,o){var r=e.target.querySelector(".popup__save");t?r.textContent=o:setTimeout((function(){r.textContent=n}),500)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var b=document.querySelector(".photo-grid__list"),g=document.getElementById("place-input"),S=document.getElementById("url-input"),q=document.getElementById("card").content.querySelector(".photo-grid__card");function k(e){var o=q.cloneNode(!0),r=o.querySelector(".photo-grid__delete");"object"===m(e)&&e.hasOwnProperty("likes")&&(o.querySelector(".photo-grid__likes").textContent=e.likes.length),e.owner._id!==i&&r.remove(),function(e,o){var r=o.querySelector(".photo-grid__like");r.addEventListener("click",(function(e){r.classList.contains("photo-grid__like_active")?function(e){var o=e.target.closest(".photo-grid__card"),r=o.getAttribute("data-id"),c=o.querySelector(".photo-grid__likes");(function(e){return fetch("".concat(t.baseUrl,"cards/likes/").concat(e),{method:"DELETE",headers:t.headers}).then(n)})(r).then((function(t){e.target.classList.remove("photo-grid__like_active"),c.textContent=t.likes.length})).catch((function(e){console.error("Ошибка в функции dislikeCard:",e)}))}(e):function(e){var o=e.target.closest(".photo-grid__card"),r=o.getAttribute("data-id"),c=o.querySelector(".photo-grid__likes");(function(e){return fetch("".concat(t.baseUrl,"cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then(n)})(r).then((function(t){e.target.classList.add("photo-grid__like_active"),c.textContent=t.likes.length})).catch((function(e){console.error("Ошибка в функции likeCard:",e)}))}(e)}));var c=e.likes.find((function(e){return e._id===i}));c&&r.classList.add("photo-grid__like_active")}(e,o);var c=o.querySelector(".photo-grid__image");return c.setAttribute("alt",c.getAttribute("alt")+" "+e.name),o.setAttribute("data-id",e._id),o.querySelector(".photo-grid__city").textContent=e.name,c.src=e.link,c.addEventListener("click",C),r&&r.addEventListener("click",L),o}var E="";function L(e){E=e.target.closest(".photo-grid__card").getAttribute("data-id"),f(D)}function C(e){var t=e.target.closest(".photo-grid__card").querySelector(".photo-grid__city");j.textContent=t.textContent,O.src=e.target.src,O.setAttribute("alt",e.target.getAttribute("alt")),f(P)}var A={form:".popup__form",input:".popup__edit",button:".popup__save",disabled:"popup__save_disabled",error:"popup__edit_error"},x=document.querySelector(".popup_type_profile"),T=document.querySelector(".popup_type_card-form"),P=document.querySelector(".popup_type_image"),U=document.querySelector(".popup_type_avatar"),D=document.querySelector(".popup_type_delete"),j=P.querySelector(".popup__place-name"),O=P.querySelector(".popup__image"),w=T.querySelector(".popup__close"),B=x.querySelector(".popup__close"),I=document.querySelector(".profile__button"),N=document.querySelector(".profile__edit"),H=U.querySelector(".popup__close"),J=document.querySelector(".profile__avatar-overlay"),K=D.querySelector(".popup__close");P.querySelector(".popup__close").addEventListener("click",(function(){_(P)})),K.addEventListener("click",(function(){_(D)})),H.addEventListener("click",(function(){_(U)})),J.addEventListener("click",(function(){f(U)})),N.addEventListener("click",(function(){f(x)})),I.addEventListener("click",(function(){f(T)})),B.addEventListener("click",(function(){_(x)})),w.addEventListener("click",(function(){_(T)})),x.addEventListener("submit",(function(e){e.preventDefault(),v(e,!0,"Сохранить","Cохранение..."),function(e,o){return fetch("".concat(t.baseUrl,"users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:e.value,about:o.value})}).then(n)}(l,s).then((function(e){u.textContent=e.name,d.textContent=e.about,_(x)})).catch((function(e){console.error("Ошибка запроса:",e)})).finally((function(){v(e,!1,"Сохранить","Cохранение...")}))})),T.addEventListener("submit",(function(e){e.preventDefault(),v(e,!0,"Создать","Cохранение..."),function(e,o){return fetch("".concat(t.baseUrl,"cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:e.value,link:o.value})}).then(n)}(g,S).then((function(t){e.target.reset();var n=k(t);b.prepend(n),o(T,A),_(T)})).catch((function(e){console.error("Ошибка запроса:",e)})).finally((function(){v(e,!1,"Создать","Cохранение...")}))})),U.addEventListener("submit",(function(e){e.preventDefault(),v(e,!0,"Сохранить","Cохранение..."),function(e){return fetch("".concat(t.baseUrl,"users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:e.value})}).then(n)}(p).then((function(t){a.src=t.avatar,e.target.reset(),o(U,A),_(U)})).catch((function(e){console.error("Ошибка запроса:",e)})).finally((function(){v(e,!1,"Сохранить","Cохранение...")}))})),D.addEventListener("submit",(function(e){!function(e,o){e.preventDefault(),v(e,!0,"Да","Удаление..."),function(e){return fetch("".concat(t.baseUrl,"cards/").concat(e),{method:"DELETE",headers:t.headers}).then(n)}(o).then((function(){document.querySelector('[data-id="'.concat(o,'"]')).remove(),_(D)})).catch((function(e){console.error("Ошибка в функции deleteCard:",e)})).finally((function(){v(e,!1,"Да","Удаление...")}))}(e,E)})),function(e){Array.from(document.querySelectorAll(e.form)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.input)),o=e.querySelector(t.button);c(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.error),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.error),r.textContent=n}(e,t,t.validationMessage,n)}(e,r,t),c(n,o,t)}))}))}(t,e)}))}(A),fetch("".concat(t.baseUrl,"users/me"),{headers:t.headers}).then(n).then((function(e){i=e._id,function(e){u.textContent=e.name,d.textContent=e.about,a.src=e.avatar}(e),l.value=u.textContent,s.value=d.textContent,o(x,A),fetch("".concat(t.baseUrl,"cards"),{headers:t.headers}).then(n).then((function(e){!function(e){e.forEach((function(e){var t=k(e);b.prepend(t)}))}(e)})).catch((function(e){console.error("Ошибка в функции getDataProfile:",e)}))})).catch((function(e){console.error("Ошибка в функции getDataProfile:",e)}))})();